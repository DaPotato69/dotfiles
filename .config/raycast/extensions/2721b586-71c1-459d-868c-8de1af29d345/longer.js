var Di=Object.create;var er=Object.defineProperty;var Wi=Object.getOwnPropertyDescriptor;var qi=Object.getOwnPropertyNames;var Fi=Object.getPrototypeOf,Li=Object.prototype.hasOwnProperty;var mt=(a,n)=>()=>(a&&(n=a(a=0)),n);var Vr=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),Co=(a,n)=>{for(var o in n)er(a,o,{get:n[o],enumerable:!0})},Eo=(a,n,o,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of qi(n))!Li.call(a,l)&&l!==o&&er(a,l,{get:()=>n[l],enumerable:!(s=Wi(n,l))||s.enumerable});return a};var Ce=(a,n,o)=>(o=a!=null?Di(Fi(a)):{},Eo(n||!a||!a.__esModule?er(o,"default",{value:a,enumerable:!0}):o,a)),Ii=a=>Eo(er({},"__esModule",{value:!0}),a);var vo=Vr((tr,Ao)=>{(function(a,n){typeof tr=="object"&&typeof Ao<"u"?n(tr):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.WebStreamsPolyfill={}))})(tr,function(a){"use strict";let n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function o(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let l=s();function f(e){return typeof e=="object"&&e!==null||typeof e=="function"}let m=o,_=Promise,y=Promise.prototype.then,b=Promise.resolve.bind(_),E=Promise.reject.bind(_);function R(e){return new _(e)}function S(e){return b(e)}function p(e){return E(e)}function h(e,t,r){return y.call(e,t,r)}function q(e,t,r){h(h(e,t,r),void 0,m)}function v(e,t){q(e,t)}function T(e,t){q(e,void 0,t)}function I(e,t,r){return h(e,t,r)}function O(e){h(e,void 0,m)}let P=(()=>{let e=l&&l.queueMicrotask;if(typeof e=="function")return e;let t=S(void 0);return r=>h(t,r)})();function L(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function k(e,t,r){try{return S(L(e,t,r))}catch(i){return p(i)}}let ae=16384;class V{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let r=this._back,i=r;r._elements.length===ae-1&&(i={_elements:[],_next:void 0}),r._elements.push(t),i!==r&&(this._back=i,r._next=i),++this._size}shift(){let t=this._front,r=t,i=this._cursor,u=i+1,d=t._elements,c=d[i];return u===ae&&(r=t._next,u=0),--this._size,this._cursor=u,t!==r&&(this._front=r),d[i]=void 0,c}forEach(t){let r=this._cursor,i=this._front,u=i._elements;for(;(r!==u.length||i._next!==void 0)&&!(r===u.length&&(i=i._next,u=i._elements,r=0,u.length===0));)t(u[r]),++r}peek(){let t=this._front,r=this._cursor;return t._elements[r]}}function ln(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?br(e):t._state==="closed"?sa(e):un(e,t._storedError)}function mr(e,t){let r=e._ownerReadableStream;return re(r,t)}function ue(e){e._ownerReadableStream._state==="readable"?pr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):la(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ze(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function br(e){e._closedPromise=R((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function un(e,t){br(e),pr(e,t)}function sa(e){br(e),fn(e)}function pr(e,t){e._closedPromise_reject!==void 0&&(O(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function la(e,t){un(e,t)}function fn(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let dn=n("[[AbortSteps]]"),cn=n("[[ErrorSteps]]"),yr=n("[[CancelSteps]]"),gr=n("[[PullSteps]]"),hn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},ua=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function fa(e){return typeof e=="object"||typeof e=="function"}function fe(e,t){if(e!==void 0&&!fa(e))throw new TypeError(`${t} is not an object.`)}function ee(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function da(e){return typeof e=="object"&&e!==null||typeof e=="function"}function mn(e,t){if(!da(e))throw new TypeError(`${t} is not an object.`)}function de(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function _r(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function Sr(e){return Number(e)}function bn(e){return e===0?0:e}function ca(e){return bn(ua(e))}function pn(e,t){let i=Number.MAX_SAFE_INTEGER,u=Number(e);if(u=bn(u),!hn(u))throw new TypeError(`${t} is not a finite number`);if(u=ca(u),u<0||u>i)throw new TypeError(`${t} is outside the accepted range of 0 to ${i}, inclusive`);return!hn(u)||u===0?0:u}function wr(e,t){if(!we(e))throw new TypeError(`${t} is not a ReadableStream.`)}function Me(e){return new Xe(e)}function yn(e,t){e._reader._readRequests.push(t)}function Rr(e,t,r){let u=e._reader._readRequests.shift();r?u._closeSteps():u._chunkSteps(t)}function Rt(e){return e._reader._readRequests.length}function gn(e){let t=e._reader;return!(t===void 0||!ye(t))}class Xe{constructor(t){if(de(t,1,"ReadableStreamDefaultReader"),wr(t,"First parameter"),Re(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ln(this,t),this._readRequests=new V}get closed(){return ye(this)?this._closedPromise:p(Tt("closed"))}cancel(t=void 0){return ye(this)?this._ownerReadableStream===void 0?p(ze("cancel")):mr(this,t):p(Tt("cancel"))}read(){if(!ye(this))return p(Tt("read"));if(this._ownerReadableStream===void 0)return p(ze("read from"));let t,r,i=R((d,c)=>{t=d,r=c});return et(this,{_chunkSteps:d=>t({value:d,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:d=>r(d)}),i}releaseLock(){if(!ye(this))throw Tt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(Xe.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Xe.prototype,n.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function ye(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Xe}function et(e,t){let r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[gr](t)}function Tt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let _n=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Sn{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?I(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let r=()=>this._returnSteps(t);return this._ongoingPromise?I(this._ongoingPromise,r,r):r()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return p(ze("iterate"));let r,i,u=R((c,g)=>{r=c,i=g});return et(t,{_chunkSteps:c=>{this._ongoingPromise=void 0,P(()=>r({value:c,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),r({value:void 0,done:!0})},_errorSteps:c=>{this._ongoingPromise=void 0,this._isFinished=!0,ue(t),i(c)}}),u}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let r=this._reader;if(r._ownerReadableStream===void 0)return p(ze("finish iterating"));if(!this._preventCancel){let i=mr(r,t);return ue(r),I(i,()=>({value:t,done:!0}))}return ue(r),S({value:t,done:!0})}}let wn={next(){return Rn(this)?this._asyncIteratorImpl.next():p(Tn("next"))},return(e){return Rn(this)?this._asyncIteratorImpl.return(e):p(Tn("return"))}};_n!==void 0&&Object.setPrototypeOf(wn,_n);function ha(e,t){let r=Me(e),i=new Sn(r,t),u=Object.create(wn);return u._asyncIteratorImpl=i,u}function Rn(e){if(!f(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Sn}catch{return!1}}function Tn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Cn=Number.isNaN||function(e){return e!==e};function tt(e){return e.slice()}function En(e,t,r,i,u){new Uint8Array(e).set(new Uint8Array(r,i,u),t)}function fs(e){return e}function Ct(e){return!1}function Pn(e,t,r){if(e.slice)return e.slice(t,r);let i=r-t,u=new ArrayBuffer(i);return En(u,0,e,t,i),u}function ma(e){return!(typeof e!="number"||Cn(e)||e<0)}function An(e){let t=Pn(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Tr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Cr(e,t,r){if(!ma(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function ba(e){return e._queue.peek().value}function ge(e){e._queue=new V,e._queueTotalSize=0}class rt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Er(this))throw Br("view");return this._view}respond(t){if(!Er(this))throw Br("respond");if(de(t,1,"respond"),t=pn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Ct(this._view.buffer),Bt(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Er(this))throw Br("respondWithNewView");if(de(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Ct(t.buffer),kt(this._associatedReadableByteStreamController,t)}}Object.defineProperties(rt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(rt.prototype,n.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class $e{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Pe(this))throw ot("byobRequest");return vr(this)}get desiredSize(){if(!Pe(this))throw ot("desiredSize");return Fn(this)}close(){if(!Pe(this))throw ot("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);nt(this)}enqueue(t){if(!Pe(this))throw ot("enqueue");if(de(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);vt(this,t)}error(t=void 0){if(!Pe(this))throw ot("error");te(this,t)}[yr](t){vn(this),ge(this);let r=this._cancelAlgorithm(t);return At(this),r}[gr](t){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0){let u=this._queue.shift();this._queueTotalSize-=u.byteLength,Dn(this);let d=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);t._chunkSteps(d);return}let i=this._autoAllocateChunkSize;if(i!==void 0){let u;try{u=new ArrayBuffer(i)}catch(c){t._errorSteps(c);return}let d={buffer:u,bufferByteLength:i,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(d)}yn(r,t),Ae(this)}}Object.defineProperties($e.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty($e.prototype,n.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Pe(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof $e}function Er(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof rt}function Ae(e){if(!_a(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();q(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ae(e))},i=>{te(e,i)})}function vn(e){Ar(e),e._pendingPullIntos=new V}function Pr(e,t){let r=!1;e._state==="closed"&&(r=!0);let i=Bn(t);t.readerType==="default"?Rr(e,i,r):Ra(e,i,r)}function Bn(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Et(e,t,r,i){e._queue.push({buffer:t,byteOffset:r,byteLength:i}),e._queueTotalSize+=i}function kn(e,t){let r=t.elementSize,i=t.bytesFilled-t.bytesFilled%r,u=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),d=t.bytesFilled+u,c=d-d%r,g=u,C=!1;c>i&&(g=c-t.bytesFilled,C=!0);let B=e._queue;for(;g>0;){let D=B.peek(),W=Math.min(g,D.byteLength),$=t.byteOffset+t.bytesFilled;En(t.buffer,$,D.buffer,D.byteOffset,W),D.byteLength===W?B.shift():(D.byteOffset+=W,D.byteLength-=W),e._queueTotalSize-=W,On(e,W,t),g-=W}return C}function On(e,t,r){r.bytesFilled+=t}function Dn(e){e._queueTotalSize===0&&e._closeRequested?(At(e),ct(e._controlledReadableByteStream)):Ae(e)}function Ar(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Wn(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();kn(e,t)&&(Pt(e),Pr(e._controlledReadableByteStream,t))}}function pa(e,t,r){let i=e._controlledReadableByteStream,u=1;t.constructor!==DataView&&(u=t.constructor.BYTES_PER_ELEMENT);let d=t.constructor,c=t.buffer,g={buffer:c,bufferByteLength:c.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:u,viewConstructor:d,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(g),zn(i,r);return}if(i._state==="closed"){let C=new d(g.buffer,g.byteOffset,0);r._closeSteps(C);return}if(e._queueTotalSize>0){if(kn(e,g)){let C=Bn(g);Dn(e),r._chunkSteps(C);return}if(e._closeRequested){let C=new TypeError("Insufficient bytes to fill elements in the given buffer");te(e,C),r._errorSteps(C);return}}e._pendingPullIntos.push(g),zn(i,r),Ae(e)}function ya(e,t){let r=e._controlledReadableByteStream;if(kr(r))for(;Mn(r)>0;){let i=Pt(e);Pr(r,i)}}function ga(e,t,r){if(On(e,t,r),r.bytesFilled<r.elementSize)return;Pt(e);let i=r.bytesFilled%r.elementSize;if(i>0){let u=r.byteOffset+r.bytesFilled,d=Pn(r.buffer,u-i,u);Et(e,d,0,d.byteLength)}r.bytesFilled-=i,Pr(e._controlledReadableByteStream,r),Wn(e)}function qn(e,t){let r=e._pendingPullIntos.peek();Ar(e),e._controlledReadableByteStream._state==="closed"?ya(e):ga(e,t,r),Ae(e)}function Pt(e){return e._pendingPullIntos.shift()}function _a(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(gn(t)&&Rt(t)>0||kr(t)&&Mn(t)>0||Fn(e)>0)}function At(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function nt(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let i=new TypeError("Insufficient bytes to fill elements in the given buffer");throw te(e,i),i}At(e),ct(t)}}function vt(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;let i=t.buffer,u=t.byteOffset,d=t.byteLength,c=i;if(e._pendingPullIntos.length>0){let g=e._pendingPullIntos.peek();Ct(g.buffer),g.buffer=g.buffer}if(Ar(e),gn(r))if(Rt(r)===0)Et(e,c,u,d);else{e._pendingPullIntos.length>0&&Pt(e);let g=new Uint8Array(c,u,d);Rr(r,g,!1)}else kr(r)?(Et(e,c,u,d),Wn(e)):Et(e,c,u,d);Ae(e)}function te(e,t){let r=e._controlledReadableByteStream;r._state==="readable"&&(vn(e),ge(e),At(e),uo(r,t))}function vr(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(rt.prototype);wa(i,e,r),e._byobRequest=i}return e._byobRequest}function Fn(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Bt(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=r.buffer,qn(e,t)}function kt(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let u=t.byteLength;r.buffer=t.buffer,qn(e,u)}function Ln(e,t,r,i,u,d,c){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,ge(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=d,t._pullAlgorithm=i,t._cancelAlgorithm=u,t._autoAllocateChunkSize=c,t._pendingPullIntos=new V,e._readableStreamController=t;let g=r();q(S(g),()=>{t._started=!0,Ae(t)},C=>{te(t,C)})}function Sa(e,t,r){let i=Object.create($e.prototype),u=()=>{},d=()=>S(void 0),c=()=>S(void 0);t.start!==void 0&&(u=()=>t.start(i)),t.pull!==void 0&&(d=()=>t.pull(i)),t.cancel!==void 0&&(c=C=>t.cancel(C));let g=t.autoAllocateChunkSize;if(g===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ln(e,i,u,d,c,r,g)}function wa(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function Br(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function ot(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function In(e){return new at(e)}function zn(e,t){e._reader._readIntoRequests.push(t)}function Ra(e,t,r){let u=e._reader._readIntoRequests.shift();r?u._closeSteps(t):u._chunkSteps(t)}function Mn(e){return e._reader._readIntoRequests.length}function kr(e){let t=e._reader;return!(t===void 0||!ve(t))}class at{constructor(t){if(de(t,1,"ReadableStreamBYOBReader"),wr(t,"First parameter"),Re(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Pe(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ln(this,t),this._readIntoRequests=new V}get closed(){return ve(this)?this._closedPromise:p(Ot("closed"))}cancel(t=void 0){return ve(this)?this._ownerReadableStream===void 0?p(ze("cancel")):mr(this,t):p(Ot("cancel"))}read(t){if(!ve(this))return p(Ot("read"));if(!ArrayBuffer.isView(t))return p(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return p(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return p(new TypeError("view's buffer must have non-zero byteLength"));if(Ct(t.buffer),this._ownerReadableStream===void 0)return p(ze("read from"));let r,i,u=R((c,g)=>{r=c,i=g});return $n(this,t,{_chunkSteps:c=>r({value:c,done:!1}),_closeSteps:c=>r({value:c,done:!0}),_errorSteps:c=>i(c)}),u}releaseLock(){if(!ve(this))throw Ot("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ue(this)}}}Object.defineProperties(at.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(at.prototype,n.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function ve(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof at}function $n(e,t,r){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="errored"?r._errorSteps(i._storedError):pa(i._readableStreamController,t,r)}function Ot(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function it(e,t){let{highWaterMark:r}=e;if(r===void 0)return t;if(Cn(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Dt(e){let{size:t}=e;return t||(()=>1)}function Wt(e,t){fe(e,t);let r=e?.highWaterMark,i=e?.size;return{highWaterMark:r===void 0?void 0:Sr(r),size:i===void 0?void 0:Ta(i,`${t} has member 'size' that`)}}function Ta(e,t){return ee(e,t),r=>Sr(e(r))}function Ca(e,t){fe(e,t);let r=e?.abort,i=e?.close,u=e?.start,d=e?.type,c=e?.write;return{abort:r===void 0?void 0:Ea(r,e,`${t} has member 'abort' that`),close:i===void 0?void 0:Pa(i,e,`${t} has member 'close' that`),start:u===void 0?void 0:Aa(u,e,`${t} has member 'start' that`),write:c===void 0?void 0:va(c,e,`${t} has member 'write' that`),type:d}}function Ea(e,t,r){return ee(e,r),i=>k(e,t,[i])}function Pa(e,t,r){return ee(e,r),()=>k(e,t,[])}function Aa(e,t,r){return ee(e,r),i=>L(e,t,[i])}function va(e,t,r){return ee(e,r),(i,u)=>k(e,t,[i,u])}function xn(e,t){if(!xe(e))throw new TypeError(`${t} is not a WritableStream.`)}function Ba(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let ka=typeof AbortController=="function";function Oa(){if(ka)return new AbortController}class st{constructor(t={},r={}){t===void 0?t=null:mn(t,"First parameter");let i=Wt(r,"Second parameter"),u=Ca(t,"First parameter");if(jn(this),u.type!==void 0)throw new RangeError("Invalid type is specified");let c=Dt(i),g=it(i,1);Ha(this,u,g,c)}get locked(){if(!xe(this))throw zt("locked");return Ue(this)}abort(t=void 0){return xe(this)?Ue(this)?p(new TypeError("Cannot abort a stream that already has a writer")):qt(this,t):p(zt("abort"))}close(){return xe(this)?Ue(this)?p(new TypeError("Cannot close a stream that already has a writer")):ie(this)?p(new TypeError("Cannot close an already-closing stream")):Nn(this):p(zt("close"))}getWriter(){if(!xe(this))throw zt("getWriter");return Un(this)}}Object.defineProperties(st.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(st.prototype,n.toStringTag,{value:"WritableStream",configurable:!0});function Un(e){return new lt(e)}function Da(e,t,r,i,u=1,d=()=>1){let c=Object.create(st.prototype);jn(c);let g=Object.create(je.prototype);return Jn(c,g,e,t,r,i,u,d),c}function jn(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new V,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function xe(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof st}function Ue(e){return e._writer!==void 0}function qt(e,t){var r;if(e._state==="closed"||e._state==="errored")return S(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort();let i=e._state;if(i==="closed"||i==="errored")return S(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let u=!1;i==="erroring"&&(u=!0,t=void 0);let d=R((c,g)=>{e._pendingAbortRequest={_promise:void 0,_resolve:c,_reject:g,_reason:t,_wasAlreadyErroring:u}});return e._pendingAbortRequest._promise=d,u||Dr(e,t),d}function Nn(e){let t=e._state;if(t==="closed"||t==="errored")return p(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let r=R((u,d)=>{let c={_resolve:u,_reject:d};e._closeRequest=c}),i=e._writer;return i!==void 0&&e._backpressure&&t==="writable"&&xr(i),Va(e._writableStreamController),r}function Wa(e){return R((r,i)=>{let u={_resolve:r,_reject:i};e._writeRequests.push(u)})}function Or(e,t){if(e._state==="writable"){Dr(e,t);return}Wr(e)}function Dr(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let i=e._writer;i!==void 0&&Vn(i,t),!za(e)&&r._started&&Wr(e)}function Wr(e){e._state="errored",e._writableStreamController[cn]();let t=e._storedError;if(e._writeRequests.forEach(u=>{u._reject(t)}),e._writeRequests=new V,e._pendingAbortRequest===void 0){Ft(e);return}let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring){r._reject(t),Ft(e);return}let i=e._writableStreamController[dn](r._reason);q(i,()=>{r._resolve(),Ft(e)},u=>{r._reject(u),Ft(e)})}function qa(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Fa(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,Or(e,t)}function La(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let r=e._writer;r!==void 0&&eo(r)}function Ia(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),Or(e,t)}function ie(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function za(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ma(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function $a(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Ft(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&Mr(t,e._storedError)}function qr(e,t){let r=e._writer;r!==void 0&&t!==e._backpressure&&(t?Xa(r):xr(r)),e._backpressure=t}class lt{constructor(t){if(de(t,1,"WritableStreamDefaultWriter"),xn(t,"First parameter"),Ue(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let r=t._state;if(r==="writable")!ie(t)&&t._backpressure?$t(this):to(this),Mt(this);else if(r==="erroring")$r(this,t._storedError),Mt(this);else if(r==="closed")to(this),Za(this);else{let i=t._storedError;$r(this,i),Xn(this,i)}}get closed(){return Be(this)?this._closedPromise:p(ke("closed"))}get desiredSize(){if(!Be(this))throw ke("desiredSize");if(this._ownerWritableStream===void 0)throw ut("desiredSize");return Na(this)}get ready(){return Be(this)?this._readyPromise:p(ke("ready"))}abort(t=void 0){return Be(this)?this._ownerWritableStream===void 0?p(ut("abort")):xa(this,t):p(ke("abort"))}close(){if(!Be(this))return p(ke("close"));let t=this._ownerWritableStream;return t===void 0?p(ut("close")):ie(t)?p(new TypeError("Cannot close an already-closing stream")):Hn(this)}releaseLock(){if(!Be(this))throw ke("releaseLock");this._ownerWritableStream!==void 0&&Yn(this)}write(t=void 0){return Be(this)?this._ownerWritableStream===void 0?p(ut("write to")):Qn(this,t):p(ke("write"))}}Object.defineProperties(lt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(lt.prototype,n.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Be(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof lt}function xa(e,t){let r=e._ownerWritableStream;return qt(r,t)}function Hn(e){let t=e._ownerWritableStream;return Nn(t)}function Ua(e){let t=e._ownerWritableStream,r=t._state;return ie(t)||r==="closed"?S(void 0):r==="errored"?p(t._storedError):Hn(e)}function ja(e,t){e._closedPromiseState==="pending"?Mr(e,t):Ka(e,t)}function Vn(e,t){e._readyPromiseState==="pending"?ro(e,t):ei(e,t)}function Na(e){let t=e._ownerWritableStream,r=t._state;return r==="errored"||r==="erroring"?null:r==="closed"?0:Zn(t._writableStreamController)}function Yn(e){let t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Vn(e,r),ja(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Qn(e,t){let r=e._ownerWritableStream,i=r._writableStreamController,u=Ya(i,t);if(r!==e._ownerWritableStream)return p(ut("write to"));let d=r._state;if(d==="errored")return p(r._storedError);if(ie(r)||d==="closed")return p(new TypeError("The stream is closing or closed and cannot be written to"));if(d==="erroring")return p(r._storedError);let c=Wa(r);return Qa(i,t,u),c}let Gn={};class je{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Fr(this))throw zr("abortReason");return this._abortReason}get signal(){if(!Fr(this))throw zr("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!Fr(this))throw zr("error");this._controlledWritableStream._state==="writable"&&Kn(this,t)}[dn](t){let r=this._abortAlgorithm(t);return Lt(this),r}[cn](){ge(this)}}Object.defineProperties(je.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(je.prototype,n.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Fr(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof je}function Jn(e,t,r,i,u,d,c,g){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,ge(t),t._abortReason=void 0,t._abortController=Oa(),t._started=!1,t._strategySizeAlgorithm=g,t._strategyHWM=c,t._writeAlgorithm=i,t._closeAlgorithm=u,t._abortAlgorithm=d;let C=Ir(t);qr(e,C);let B=r(),D=S(B);q(D,()=>{t._started=!0,It(t)},W=>{t._started=!0,Or(e,W)})}function Ha(e,t,r,i){let u=Object.create(je.prototype),d=()=>{},c=()=>S(void 0),g=()=>S(void 0),C=()=>S(void 0);t.start!==void 0&&(d=()=>t.start(u)),t.write!==void 0&&(c=B=>t.write(B,u)),t.close!==void 0&&(g=()=>t.close()),t.abort!==void 0&&(C=B=>t.abort(B)),Jn(e,u,d,c,g,C,r,i)}function Lt(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Va(e){Cr(e,Gn,0),It(e)}function Ya(e,t){try{return e._strategySizeAlgorithm(t)}catch(r){return Lr(e,r),1}}function Zn(e){return e._strategyHWM-e._queueTotalSize}function Qa(e,t,r){try{Cr(e,t,r)}catch(u){Lr(e,u);return}let i=e._controlledWritableStream;if(!ie(i)&&i._state==="writable"){let u=Ir(e);qr(i,u)}It(e)}function It(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){Wr(t);return}if(e._queue.length===0)return;let i=ba(e);i===Gn?Ga(e):Ja(e,i)}function Lr(e,t){e._controlledWritableStream._state==="writable"&&Kn(e,t)}function Ga(e){let t=e._controlledWritableStream;Ma(t),Tr(e);let r=e._closeAlgorithm();Lt(e),q(r,()=>{La(t)},i=>{Ia(t,i)})}function Ja(e,t){let r=e._controlledWritableStream;$a(r);let i=e._writeAlgorithm(t);q(i,()=>{qa(r);let u=r._state;if(Tr(e),!ie(r)&&u==="writable"){let d=Ir(e);qr(r,d)}It(e)},u=>{r._state==="writable"&&Lt(e),Fa(r,u)})}function Ir(e){return Zn(e)<=0}function Kn(e,t){let r=e._controlledWritableStream;Lt(e),Dr(r,t)}function zt(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function zr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function ke(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function ut(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Mt(e){e._closedPromise=R((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function Xn(e,t){Mt(e),Mr(e,t)}function Za(e){Mt(e),eo(e)}function Mr(e,t){e._closedPromise_reject!==void 0&&(O(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Ka(e,t){Xn(e,t)}function eo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function $t(e){e._readyPromise=R((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function $r(e,t){$t(e),ro(e,t)}function to(e){$t(e),xr(e)}function ro(e,t){e._readyPromise_reject!==void 0&&(O(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Xa(e){$t(e)}function ei(e,t){$r(e,t)}function xr(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let no=typeof DOMException<"u"?DOMException:void 0;function ti(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function ri(){let e=function(r,i){this.message=r||"",this.name=i||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let ni=ti(no)?no:ri();function oo(e,t,r,i,u,d){let c=Me(e),g=Un(t);e._disturbed=!0;let C=!1,B=S(void 0);return R((D,W)=>{let $;if(d!==void 0){if($=()=>{let w=new ni("Aborted","AbortError"),A=[];i||A.push(()=>t._state==="writable"?qt(t,w):S(void 0)),u||A.push(()=>e._state==="readable"?re(e,w):S(void 0)),j(()=>Promise.all(A.map(z=>z())),!0,w)},d.aborted){$();return}d.addEventListener("abort",$)}function ne(){return R((w,A)=>{function z(Y){Y?w():h(Ve(),z,A)}z(!1)})}function Ve(){return C?S(!0):h(g._readyPromise,()=>R((w,A)=>{et(c,{_chunkSteps:z=>{B=h(Qn(g,z),void 0,o),w(!1)},_closeSteps:()=>w(!0),_errorSteps:A})}))}if(ce(e,c._closedPromise,w=>{i?Z(!0,w):j(()=>qt(t,w),!0,w)}),ce(t,g._closedPromise,w=>{u?Z(!0,w):j(()=>re(e,w),!0,w)}),U(e,c._closedPromise,()=>{r?Z():j(()=>Ua(g))}),ie(t)||t._state==="closed"){let w=new TypeError("the destination writable stream closed before all data could be piped to it");u?Z(!0,w):j(()=>re(e,w),!0,w)}O(ne());function Te(){let w=B;return h(B,()=>w!==B?Te():void 0)}function ce(w,A,z){w._state==="errored"?z(w._storedError):T(A,z)}function U(w,A,z){w._state==="closed"?z():v(A,z)}function j(w,A,z){if(C)return;C=!0,t._state==="writable"&&!ie(t)?v(Te(),Y):Y();function Y(){q(w(),()=>he(A,z),Ye=>he(!0,Ye))}}function Z(w,A){C||(C=!0,t._state==="writable"&&!ie(t)?v(Te(),()=>he(w,A)):he(w,A))}function he(w,A){Yn(g),ue(c),d!==void 0&&d.removeEventListener("abort",$),w?W(A):D(void 0)}})}class Ne{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!xt(this))throw Nt("desiredSize");return Ur(this)}close(){if(!xt(this))throw Nt("close");if(!He(this))throw new TypeError("The stream is not in a state that permits close");dt(this)}enqueue(t=void 0){if(!xt(this))throw Nt("enqueue");if(!He(this))throw new TypeError("The stream is not in a state that permits enqueue");return jt(this,t)}error(t=void 0){if(!xt(this))throw Nt("error");_e(this,t)}[yr](t){ge(this);let r=this._cancelAlgorithm(t);return Ut(this),r}[gr](t){let r=this._controlledReadableStream;if(this._queue.length>0){let i=Tr(this);this._closeRequested&&this._queue.length===0?(Ut(this),ct(r)):ft(this),t._chunkSteps(i)}else yn(r,t),ft(this)}}Object.defineProperties(Ne.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Ne.prototype,n.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function xt(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof Ne}function ft(e){if(!ao(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();q(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ft(e))},i=>{_e(e,i)})}function ao(e){let t=e._controlledReadableStream;return!He(e)||!e._started?!1:!!(Re(t)&&Rt(t)>0||Ur(e)>0)}function Ut(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function dt(e){if(!He(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Ut(e),ct(t))}function jt(e,t){if(!He(e))return;let r=e._controlledReadableStream;if(Re(r)&&Rt(r)>0)Rr(r,t,!1);else{let i;try{i=e._strategySizeAlgorithm(t)}catch(u){throw _e(e,u),u}try{Cr(e,t,i)}catch(u){throw _e(e,u),u}}ft(e)}function _e(e,t){let r=e._controlledReadableStream;r._state==="readable"&&(ge(e),Ut(e),uo(r,t))}function Ur(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function oi(e){return!ao(e)}function He(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function io(e,t,r,i,u,d,c){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,ge(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=c,t._strategyHWM=d,t._pullAlgorithm=i,t._cancelAlgorithm=u,e._readableStreamController=t;let g=r();q(S(g),()=>{t._started=!0,ft(t)},C=>{_e(t,C)})}function ai(e,t,r,i){let u=Object.create(Ne.prototype),d=()=>{},c=()=>S(void 0),g=()=>S(void 0);t.start!==void 0&&(d=()=>t.start(u)),t.pull!==void 0&&(c=()=>t.pull(u)),t.cancel!==void 0&&(g=C=>t.cancel(C)),io(e,u,d,c,g,r,i)}function Nt(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function ii(e,t){return Pe(e._readableStreamController)?li(e):si(e)}function si(e,t){let r=Me(e),i=!1,u=!1,d=!1,c=!1,g,C,B,D,W,$=R(U=>{W=U});function ne(){return i?(u=!0,S(void 0)):(i=!0,et(r,{_chunkSteps:j=>{P(()=>{u=!1;let Z=j,he=j;d||jt(B._readableStreamController,Z),c||jt(D._readableStreamController,he),i=!1,u&&ne()})},_closeSteps:()=>{i=!1,d||dt(B._readableStreamController),c||dt(D._readableStreamController),(!d||!c)&&W(void 0)},_errorSteps:()=>{i=!1}}),S(void 0))}function Ve(U){if(d=!0,g=U,c){let j=tt([g,C]),Z=re(e,j);W(Z)}return $}function Te(U){if(c=!0,C=U,d){let j=tt([g,C]),Z=re(e,j);W(Z)}return $}function ce(){}return B=jr(ce,ne,Ve),D=jr(ce,ne,Te),T(r._closedPromise,U=>{_e(B._readableStreamController,U),_e(D._readableStreamController,U),(!d||!c)&&W(void 0)}),[B,D]}function li(e){let t=Me(e),r=!1,i=!1,u=!1,d=!1,c=!1,g,C,B,D,W,$=R(w=>{W=w});function ne(w){T(w._closedPromise,A=>{w===t&&(te(B._readableStreamController,A),te(D._readableStreamController,A),(!d||!c)&&W(void 0))})}function Ve(){ve(t)&&(ue(t),t=Me(e),ne(t)),et(t,{_chunkSteps:A=>{P(()=>{i=!1,u=!1;let z=A,Y=A;if(!d&&!c)try{Y=An(A)}catch(Ye){te(B._readableStreamController,Ye),te(D._readableStreamController,Ye),W(re(e,Ye));return}d||vt(B._readableStreamController,z),c||vt(D._readableStreamController,Y),r=!1,i?ce():u&&U()})},_closeSteps:()=>{r=!1,d||nt(B._readableStreamController),c||nt(D._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&Bt(B._readableStreamController,0),D._readableStreamController._pendingPullIntos.length>0&&Bt(D._readableStreamController,0),(!d||!c)&&W(void 0)},_errorSteps:()=>{r=!1}})}function Te(w,A){ye(t)&&(ue(t),t=In(e),ne(t));let z=A?D:B,Y=A?B:D;$n(t,w,{_chunkSteps:Qe=>{P(()=>{i=!1,u=!1;let Ge=A?c:d;if(A?d:c)Ge||kt(z._readableStreamController,Qe);else{let To;try{To=An(Qe)}catch(Hr){te(z._readableStreamController,Hr),te(Y._readableStreamController,Hr),W(re(e,Hr));return}Ge||kt(z._readableStreamController,Qe),vt(Y._readableStreamController,To)}r=!1,i?ce():u&&U()})},_closeSteps:Qe=>{r=!1;let Ge=A?c:d,Xt=A?d:c;Ge||nt(z._readableStreamController),Xt||nt(Y._readableStreamController),Qe!==void 0&&(Ge||kt(z._readableStreamController,Qe),!Xt&&Y._readableStreamController._pendingPullIntos.length>0&&Bt(Y._readableStreamController,0)),(!Ge||!Xt)&&W(void 0)},_errorSteps:()=>{r=!1}})}function ce(){if(r)return i=!0,S(void 0);r=!0;let w=vr(B._readableStreamController);return w===null?Ve():Te(w._view,!1),S(void 0)}function U(){if(r)return u=!0,S(void 0);r=!0;let w=vr(D._readableStreamController);return w===null?Ve():Te(w._view,!0),S(void 0)}function j(w){if(d=!0,g=w,c){let A=tt([g,C]),z=re(e,A);W(z)}return $}function Z(w){if(c=!0,C=w,d){let A=tt([g,C]),z=re(e,A);W(z)}return $}function he(){}return B=lo(he,ce,j),D=lo(he,U,Z),ne(t),[B,D]}function ui(e,t){fe(e,t);let r=e,i=r?.autoAllocateChunkSize,u=r?.cancel,d=r?.pull,c=r?.start,g=r?.type;return{autoAllocateChunkSize:i===void 0?void 0:pn(i,`${t} has member 'autoAllocateChunkSize' that`),cancel:u===void 0?void 0:fi(u,r,`${t} has member 'cancel' that`),pull:d===void 0?void 0:di(d,r,`${t} has member 'pull' that`),start:c===void 0?void 0:ci(c,r,`${t} has member 'start' that`),type:g===void 0?void 0:hi(g,`${t} has member 'type' that`)}}function fi(e,t,r){return ee(e,r),i=>k(e,t,[i])}function di(e,t,r){return ee(e,r),i=>k(e,t,[i])}function ci(e,t,r){return ee(e,r),i=>L(e,t,[i])}function hi(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function mi(e,t){fe(e,t);let r=e?.mode;return{mode:r===void 0?void 0:bi(r,`${t} has member 'mode' that`)}}function bi(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function pi(e,t){return fe(e,t),{preventCancel:!!e?.preventCancel}}function so(e,t){fe(e,t);let r=e?.preventAbort,i=e?.preventCancel,u=e?.preventClose,d=e?.signal;return d!==void 0&&yi(d,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!i,preventClose:!!u,signal:d}}function yi(e,t){if(!Ba(e))throw new TypeError(`${t} is not an AbortSignal.`)}function gi(e,t){fe(e,t);let r=e?.readable;_r(r,"readable","ReadableWritablePair"),wr(r,`${t} has member 'readable' that`);let i=e?.writable;return _r(i,"writable","ReadableWritablePair"),xn(i,`${t} has member 'writable' that`),{readable:r,writable:i}}class Se{constructor(t={},r={}){t===void 0?t=null:mn(t,"First parameter");let i=Wt(r,"Second parameter"),u=ui(t,"First parameter");if(Nr(this),u.type==="bytes"){if(i.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let d=it(i,0);Sa(this,u,d)}else{let d=Dt(i),c=it(i,1);ai(this,u,c,d)}}get locked(){if(!we(this))throw Oe("locked");return Re(this)}cancel(t=void 0){return we(this)?Re(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):re(this,t):p(Oe("cancel"))}getReader(t=void 0){if(!we(this))throw Oe("getReader");return mi(t,"First parameter").mode===void 0?Me(this):In(this)}pipeThrough(t,r={}){if(!we(this))throw Oe("pipeThrough");de(t,1,"pipeThrough");let i=gi(t,"First parameter"),u=so(r,"Second parameter");if(Re(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Ue(i.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let d=oo(this,i.writable,u.preventClose,u.preventAbort,u.preventCancel,u.signal);return O(d),i.readable}pipeTo(t,r={}){if(!we(this))return p(Oe("pipeTo"));if(t===void 0)return p("Parameter 1 is required in 'pipeTo'.");if(!xe(t))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let i;try{i=so(r,"Second parameter")}catch(u){return p(u)}return Re(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Ue(t)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):oo(this,t,i.preventClose,i.preventAbort,i.preventCancel,i.signal)}tee(){if(!we(this))throw Oe("tee");let t=ii(this);return tt(t)}values(t=void 0){if(!we(this))throw Oe("values");let r=pi(t,"First parameter");return ha(this,r.preventCancel)}}Object.defineProperties(Se.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Se.prototype,n.toStringTag,{value:"ReadableStream",configurable:!0}),typeof n.asyncIterator=="symbol"&&Object.defineProperty(Se.prototype,n.asyncIterator,{value:Se.prototype.values,writable:!0,configurable:!0});function jr(e,t,r,i=1,u=()=>1){let d=Object.create(Se.prototype);Nr(d);let c=Object.create(Ne.prototype);return io(d,c,e,t,r,i,u),d}function lo(e,t,r){let i=Object.create(Se.prototype);Nr(i);let u=Object.create($e.prototype);return Ln(i,u,e,t,r,0,void 0),i}function Nr(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function we(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Se}function Re(e){return e._reader!==void 0}function re(e,t){if(e._disturbed=!0,e._state==="closed")return S(void 0);if(e._state==="errored")return p(e._storedError);ct(e);let r=e._reader;r!==void 0&&ve(r)&&(r._readIntoRequests.forEach(u=>{u._closeSteps(void 0)}),r._readIntoRequests=new V);let i=e._readableStreamController[yr](t);return I(i,o)}function ct(e){e._state="closed";let t=e._reader;t!==void 0&&(fn(t),ye(t)&&(t._readRequests.forEach(r=>{r._closeSteps()}),t._readRequests=new V))}function uo(e,t){e._state="errored",e._storedError=t;let r=e._reader;r!==void 0&&(pr(r,t),ye(r)?(r._readRequests.forEach(i=>{i._errorSteps(t)}),r._readRequests=new V):(r._readIntoRequests.forEach(i=>{i._errorSteps(t)}),r._readIntoRequests=new V))}function Oe(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function fo(e,t){fe(e,t);let r=e?.highWaterMark;return _r(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Sr(r)}}let co=e=>e.byteLength;try{Object.defineProperty(co,"name",{value:"size",configurable:!0})}catch{}class Ht{constructor(t){de(t,1,"ByteLengthQueuingStrategy"),t=fo(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!mo(this))throw ho("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!mo(this))throw ho("size");return co}}Object.defineProperties(Ht.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Ht.prototype,n.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function ho(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function mo(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Ht}let bo=()=>1;try{Object.defineProperty(bo,"name",{value:"size",configurable:!0})}catch{}class Vt{constructor(t){de(t,1,"CountQueuingStrategy"),t=fo(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!yo(this))throw po("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!yo(this))throw po("size");return bo}}Object.defineProperties(Vt.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Vt.prototype,n.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function po(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function yo(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof Vt}function _i(e,t){fe(e,t);let r=e?.flush,i=e?.readableType,u=e?.start,d=e?.transform,c=e?.writableType;return{flush:r===void 0?void 0:Si(r,e,`${t} has member 'flush' that`),readableType:i,start:u===void 0?void 0:wi(u,e,`${t} has member 'start' that`),transform:d===void 0?void 0:Ri(d,e,`${t} has member 'transform' that`),writableType:c}}function Si(e,t,r){return ee(e,r),i=>k(e,t,[i])}function wi(e,t,r){return ee(e,r),i=>L(e,t,[i])}function Ri(e,t,r){return ee(e,r),(i,u)=>k(e,t,[i,u])}class Yt{constructor(t={},r={},i={}){t===void 0&&(t=null);let u=Wt(r,"Second parameter"),d=Wt(i,"Third parameter"),c=_i(t,"First parameter");if(c.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(c.writableType!==void 0)throw new RangeError("Invalid writableType specified");let g=it(d,0),C=Dt(d),B=it(u,1),D=Dt(u),W,$=R(ne=>{W=ne});Ti(this,$,B,D,g,C),Ei(this,c),c.start!==void 0?W(c.start(this._transformStreamController)):W(void 0)}get readable(){if(!go(this))throw Ro("readable");return this._readable}get writable(){if(!go(this))throw Ro("writable");return this._writable}}Object.defineProperties(Yt.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Yt.prototype,n.toStringTag,{value:"TransformStream",configurable:!0});function Ti(e,t,r,i,u,d){function c(){return t}function g($){return vi(e,$)}function C($){return Bi(e,$)}function B(){return ki(e)}e._writable=Da(c,g,B,C,r,i);function D(){return Oi(e)}function W($){return Gt(e,$),S(void 0)}e._readable=jr(c,D,W,u,d),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Jt(e,!0),e._transformStreamController=void 0}function go(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof Yt}function Qt(e,t){_e(e._readable._readableStreamController,t),Gt(e,t)}function Gt(e,t){_o(e._transformStreamController),Lr(e._writable._writableStreamController,t),e._backpressure&&Jt(e,!1)}function Jt(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=R(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}class ht{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Zt(this))throw Kt("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return Ur(t)}enqueue(t=void 0){if(!Zt(this))throw Kt("enqueue");So(this,t)}error(t=void 0){if(!Zt(this))throw Kt("error");Pi(this,t)}terminate(){if(!Zt(this))throw Kt("terminate");Ai(this)}}Object.defineProperties(ht.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,n.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Zt(e){return!f(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof ht}function Ci(e,t,r,i){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=i}function Ei(e,t){let r=Object.create(ht.prototype),i=d=>{try{return So(r,d),S(void 0)}catch(c){return p(c)}},u=()=>S(void 0);t.transform!==void 0&&(i=d=>t.transform(d,r)),t.flush!==void 0&&(u=()=>t.flush(r)),Ci(e,r,i,u)}function _o(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function So(e,t){let r=e._controlledTransformStream,i=r._readable._readableStreamController;if(!He(i))throw new TypeError("Readable side is not in a state that permits enqueue");try{jt(i,t)}catch(d){throw Gt(r,d),r._readable._storedError}oi(i)!==r._backpressure&&Jt(r,!0)}function Pi(e,t){Qt(e._controlledTransformStream,t)}function wo(e,t){let r=e._transformAlgorithm(t);return I(r,void 0,i=>{throw Qt(e._controlledTransformStream,i),i})}function Ai(e){let t=e._controlledTransformStream,r=t._readable._readableStreamController;dt(r);let i=new TypeError("TransformStream terminated");Gt(t,i)}function vi(e,t){let r=e._transformStreamController;if(e._backpressure){let i=e._backpressureChangePromise;return I(i,()=>{let u=e._writable;if(u._state==="erroring")throw u._storedError;return wo(r,t)})}return wo(r,t)}function Bi(e,t){return Qt(e,t),S(void 0)}function ki(e){let t=e._readable,r=e._transformStreamController,i=r._flushAlgorithm();return _o(r),I(i,()=>{if(t._state==="errored")throw t._storedError;dt(t._readableStreamController)},u=>{throw Qt(e,u),t._storedError})}function Oi(e){return Jt(e,!1),e._backpressureChangePromise}function Kt(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Ro(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}a.ByteLengthQueuingStrategy=Ht,a.CountQueuingStrategy=Vt,a.ReadableByteStreamController=$e,a.ReadableStream=Se,a.ReadableStreamBYOBReader=at,a.ReadableStreamBYOBRequest=rt,a.ReadableStreamDefaultController=Ne,a.ReadableStreamDefaultReader=Xe,a.TransformStream=Yt,a.TransformStreamDefaultController=ht,a.WritableStream=st,a.WritableStreamDefaultController=je,a.WritableStreamDefaultWriter=lt,Object.defineProperty(a,"__esModule",{value:!0})})});var Bo=Vr(()=>{if(!globalThis.ReadableStream)try{let a=require("node:process"),{emitWarning:n}=a;try{a.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),a.emitWarning=n}catch(o){throw a.emitWarning=n,o}}catch{Object.assign(globalThis,vo())}try{let{Blob:a}=require("buffer");a&&!a.prototype.stream&&(a.prototype.stream=function(o){let s=0,l=this;return new ReadableStream({type:"bytes",async pull(f){let _=await l.slice(s,Math.min(l.size,s+65536)).arrayBuffer();s+=_.byteLength,f.enqueue(new Uint8Array(_)),s===l.size&&f.close()}})})}catch{}});async function*Yr(a,n=!0){for(let o of a)if("stream"in o)yield*o.stream();else if(ArrayBuffer.isView(o))if(n){let s=o.byteOffset,l=o.byteOffset+o.byteLength;for(;s!==l;){let f=Math.min(l-s,ko),m=o.buffer.slice(s,s+f);s+=m.byteLength,yield new Uint8Array(m)}}else yield o;else{let s=0,l=o;for(;s!==l.size;){let m=await l.slice(s,Math.min(l.size,s+ko)).arrayBuffer();s+=m.byteLength,yield new Uint8Array(m)}}}var bs,ko,Oo,Mi,me,bt=mt(()=>{bs=Ce(Bo(),1);ko=65536;Oo=class Qr{#e=[];#t="";#r=0;#n="transparent";constructor(n=[],o={}){if(typeof n!="object"||n===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof n[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof o!="object"&&typeof o!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");o===null&&(o={});let s=new TextEncoder;for(let f of n){let m;ArrayBuffer.isView(f)?m=new Uint8Array(f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)):f instanceof ArrayBuffer?m=new Uint8Array(f.slice(0)):f instanceof Qr?m=f:m=s.encode(`${f}`),this.#r+=ArrayBuffer.isView(m)?m.byteLength:m.size,this.#e.push(m)}this.#n=`${o.endings===void 0?"transparent":o.endings}`;let l=o.type===void 0?"":String(o.type);this.#t=/^[\x20-\x7E]*$/.test(l)?l:""}get size(){return this.#r}get type(){return this.#t}async text(){let n=new TextDecoder,o="";for await(let s of Yr(this.#e,!1))o+=n.decode(s,{stream:!0});return o+=n.decode(),o}async arrayBuffer(){let n=new Uint8Array(this.size),o=0;for await(let s of Yr(this.#e,!1))n.set(s,o),o+=s.length;return n.buffer}stream(){let n=Yr(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(o){let s=await n.next();s.done?o.close():o.enqueue(s.value)},async cancel(){await n.return()}})}slice(n=0,o=this.size,s=""){let{size:l}=this,f=n<0?Math.max(l+n,0):Math.min(n,l),m=o<0?Math.max(l+o,0):Math.min(o,l),_=Math.max(m-f,0),y=this.#e,b=[],E=0;for(let S of y){if(E>=_)break;let p=ArrayBuffer.isView(S)?S.byteLength:S.size;if(f&&p<=f)f-=p,m-=p;else{let h;ArrayBuffer.isView(S)?(h=S.subarray(f,Math.min(p,m)),E+=h.byteLength):(h=S.slice(f,Math.min(p,m)),E+=h.size),m-=p,b.push(h),f=0}}let R=new Qr([],{type:String(s).toLowerCase()});return R.#r=_,R.#e=b,R}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}};Object.defineProperties(Oo.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Mi=Oo,me=Mi});var $i,xi,Je,Gr=mt(()=>{bt();$i=class extends me{#e=0;#t="";constructor(n,o,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(n,s),s===null&&(s={});let l=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(l)||(this.#e=l),this.#t=String(o)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](n){return!!n&&n instanceof me&&/^(File)$/.test(n[Symbol.toStringTag])}},xi=$i,Je=xi});function qo(a,n=me){var o=`${Do()}${Do()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],l=`--${o}\r
Content-Disposition: form-data; name="`;return a.forEach((f,m)=>typeof f=="string"?s.push(l+Jr(m)+`"\r
\r
${f.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(l+Jr(m)+`"; filename="${Jr(f.name,1)}"\r
Content-Type: ${f.type||"application/octet-stream"}\r
\r
`,f,`\r
`)),s.push(`--${o}--`),new n(s,{type:"multipart/form-data; boundary="+o})}var pt,Ui,ji,Do,Ni,Wo,Jr,De,We,rr=mt(()=>{bt();Gr();({toStringTag:pt,iterator:Ui,hasInstance:ji}=Symbol),Do=Math.random,Ni="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),Wo=(a,n,o)=>(a+="",/^(Blob|File)$/.test(n&&n[pt])?[(o=o!==void 0?o+"":n[pt]=="File"?n.name:"blob",a),n.name!==o||n[pt]=="blob"?new Je([n],o,n):n]:[a,n+""]),Jr=(a,n)=>(n?a:a.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),De=(a,n,o)=>{if(n.length<o)throw new TypeError(`Failed to execute '${a}' on 'FormData': ${o} arguments required, but only ${n.length} present.`)},We=class{#e=[];constructor(...n){if(n.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[pt](){return"FormData"}[Ui](){return this.entries()}static[ji](n){return n&&typeof n=="object"&&n[pt]==="FormData"&&!Ni.some(o=>typeof n[o]!="function")}append(...n){De("append",arguments,2),this.#e.push(Wo(...n))}delete(n){De("delete",arguments,1),n+="",this.#e=this.#e.filter(([o])=>o!==n)}get(n){De("get",arguments,1),n+="";for(var o=this.#e,s=o.length,l=0;l<s;l++)if(o[l][0]===n)return o[l][1];return null}getAll(n,o){return De("getAll",arguments,1),o=[],n+="",this.#e.forEach(s=>s[0]===n&&o.push(s[1])),o}has(n){return De("has",arguments,1),n+="",this.#e.some(o=>o[0]===n)}forEach(n,o){De("forEach",arguments,1);for(var[s,l]of this)n.call(o,l,s,this)}set(...n){De("set",arguments,2);var o=[],s=!0;n=Wo(...n),this.#e.forEach(l=>{l[0]===n[0]?s&&(s=!o.push(n)):o.push(l)}),s&&o.push(n),this.#e=o}*entries(){yield*this.#e}*keys(){for(var[n]of this)yield n}*values(){for(var[,n]of this)yield n}}});var Mo=Vr((vs,zo)=>{if(!globalThis.DOMException)try{let{MessageChannel:a}=require("worker_threads"),n=new a().port1,o=new ArrayBuffer;n.postMessage(o,[o,o])}catch(a){a.constructor.name==="DOMException"&&(globalThis.DOMException=a.constructor)}zo.exports=globalThis.DOMException});var or,Hi,Os,Kr=mt(()=>{or=require("node:fs"),Hi=Ce(Mo(),1);Gr();bt();({stat:Os}=or.promises)});var xo={};Co(xo,{toFormData:()=>Ki});function Zi(a){let n=a.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!n)return;let o=n[2]||n[3]||"",s=o.slice(o.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(l,f)=>String.fromCharCode(f)),s}async function Ki(a,n){if(!/multipart/i.test(n))throw new TypeError("Failed to fetch");let o=n.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!o)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new Xr(o[1]||o[2]),l,f,m,_,y,b,E=[],R=new We,S=T=>{m+=v.decode(T,{stream:!0})},p=T=>{E.push(T)},h=()=>{let T=new Je(E,b,{type:y});R.append(_,T)},q=()=>{R.append(_,m)},v=new TextDecoder("utf-8");v.decode(),s.onPartBegin=function(){s.onPartData=S,s.onPartEnd=q,l="",f="",m="",_="",y="",b=null,E.length=0},s.onHeaderField=function(T){l+=v.decode(T,{stream:!0})},s.onHeaderValue=function(T){f+=v.decode(T,{stream:!0})},s.onHeaderEnd=function(){if(f+=v.decode(),l=l.toLowerCase(),l==="content-disposition"){let T=f.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);T&&(_=T[2]||T[3]||""),b=Zi(f),b&&(s.onPartData=p,s.onPartEnd=h)}else l==="content-type"&&(y=f);f="",l=""};for await(let T of a)s.write(T);return s.end(),R}var se,M,$o,Ee,ar,ir,Vi,gt,Yi,Qi,Gi,Ji,qe,Xr,Uo=mt(()=>{Kr();rr();se=0,M={START_BOUNDARY:se++,HEADER_FIELD_START:se++,HEADER_FIELD:se++,HEADER_VALUE_START:se++,HEADER_VALUE:se++,HEADER_VALUE_ALMOST_DONE:se++,HEADERS_ALMOST_DONE:se++,PART_DATA_START:se++,PART_DATA:se++,END:se++},$o=1,Ee={PART_BOUNDARY:$o,LAST_BOUNDARY:$o*=2},ar=10,ir=13,Vi=32,gt=45,Yi=58,Qi=97,Gi=122,Ji=a=>a|32,qe=()=>{},Xr=class{constructor(n){this.index=0,this.flags=0,this.onHeaderEnd=qe,this.onHeaderField=qe,this.onHeadersEnd=qe,this.onHeaderValue=qe,this.onPartBegin=qe,this.onPartData=qe,this.onPartEnd=qe,this.boundaryChars={},n=`\r
--`+n;let o=new Uint8Array(n.length);for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s),this.boundaryChars[o[s]]=!0;this.boundary=o,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=M.START_BOUNDARY}write(n){let o=0,s=n.length,l=this.index,{lookbehind:f,boundary:m,boundaryChars:_,index:y,state:b,flags:E}=this,R=this.boundary.length,S=R-1,p=n.length,h,q,v=P=>{this[P+"Mark"]=o},T=P=>{delete this[P+"Mark"]},I=(P,L,k,ae)=>{(L===void 0||L!==k)&&this[P](ae&&ae.subarray(L,k))},O=(P,L)=>{let k=P+"Mark";k in this&&(L?(I(P,this[k],o,n),delete this[k]):(I(P,this[k],n.length,n),this[k]=0))};for(o=0;o<s;o++)switch(h=n[o],b){case M.START_BOUNDARY:if(y===m.length-2){if(h===gt)E|=Ee.LAST_BOUNDARY;else if(h!==ir)return;y++;break}else if(y-1===m.length-2){if(E&Ee.LAST_BOUNDARY&&h===gt)b=M.END,E=0;else if(!(E&Ee.LAST_BOUNDARY)&&h===ar)y=0,I("onPartBegin"),b=M.HEADER_FIELD_START;else return;break}h!==m[y+2]&&(y=-2),h===m[y+2]&&y++;break;case M.HEADER_FIELD_START:b=M.HEADER_FIELD,v("onHeaderField"),y=0;case M.HEADER_FIELD:if(h===ir){T("onHeaderField"),b=M.HEADERS_ALMOST_DONE;break}if(y++,h===gt)break;if(h===Yi){if(y===1)return;O("onHeaderField",!0),b=M.HEADER_VALUE_START;break}if(q=Ji(h),q<Qi||q>Gi)return;break;case M.HEADER_VALUE_START:if(h===Vi)break;v("onHeaderValue"),b=M.HEADER_VALUE;case M.HEADER_VALUE:h===ir&&(O("onHeaderValue",!0),I("onHeaderEnd"),b=M.HEADER_VALUE_ALMOST_DONE);break;case M.HEADER_VALUE_ALMOST_DONE:if(h!==ar)return;b=M.HEADER_FIELD_START;break;case M.HEADERS_ALMOST_DONE:if(h!==ar)return;I("onHeadersEnd"),b=M.PART_DATA_START;break;case M.PART_DATA_START:b=M.PART_DATA,v("onPartData");case M.PART_DATA:if(l=y,y===0){for(o+=S;o<p&&!(n[o]in _);)o+=R;o-=S,h=n[o]}if(y<m.length)m[y]===h?(y===0&&O("onPartData",!0),y++):y=0;else if(y===m.length)y++,h===ir?E|=Ee.PART_BOUNDARY:h===gt?E|=Ee.LAST_BOUNDARY:y=0;else if(y-1===m.length)if(E&Ee.PART_BOUNDARY){if(y=0,h===ar){E&=~Ee.PART_BOUNDARY,I("onPartEnd"),I("onPartBegin"),b=M.HEADER_FIELD_START;break}}else E&Ee.LAST_BOUNDARY&&h===gt?(I("onPartEnd"),b=M.END,E=0):y=0;if(y>0)f[y-1]=h;else if(l>0){let P=new Uint8Array(f.buffer,f.byteOffset,f.byteLength);I("onPartData",0,l,P),l=0,v("onPartData"),o--}break;case M.END:break;default:throw new Error(`Unexpected state entered: ${b}`)}O("onHeaderField"),O("onHeaderValue"),O("onPartData"),this.index=y,this.state=b,this.flags=E}end(){if(this.state===M.HEADER_FIELD_START&&this.index===0||this.state===M.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==M.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var us={};Co(us,{default:()=>ia});module.exports=Ii(us);var F=require("@raycast/api"),Ie=require("react");var na=Ce(require("node:http"),1),oa=Ce(require("node:https"),1),Le=Ce(require("node:zlib"),1),J=Ce(require("node:stream"),1),wt=require("node:buffer");function zi(a){if(!/^data:/i.test(a))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');a=a.replace(/\r?\n/g,"");let n=a.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let o=a.substring(5,n).split(";"),s="",l=!1,f=o[0]||"text/plain",m=f;for(let E=1;E<o.length;E++)o[E]==="base64"?l=!0:o[E]&&(m+=`;${o[E]}`,o[E].indexOf("charset=")===0&&(s=o[E].substring(8)));!o[0]&&!s.length&&(m+=";charset=US-ASCII",s="US-ASCII");let _=l?"base64":"ascii",y=unescape(a.substring(n+1)),b=Buffer.from(y,_);return b.type=f,b.typeFull=m,b.charset=s,b}var Po=zi;var K=Ce(require("node:stream"),1),pe=require("node:util"),Q=require("node:buffer");bt();rr();var be=class extends Error{constructor(n,o){super(n),Error.captureStackTrace(this,this.constructor),this.type=o}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var N=class extends be{constructor(n,o,s){super(n,o),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var nr=Symbol.toStringTag,Zr=a=>typeof a=="object"&&typeof a.append=="function"&&typeof a.delete=="function"&&typeof a.get=="function"&&typeof a.getAll=="function"&&typeof a.has=="function"&&typeof a.set=="function"&&typeof a.sort=="function"&&a[nr]==="URLSearchParams",yt=a=>a&&typeof a=="object"&&typeof a.arrayBuffer=="function"&&typeof a.type=="string"&&typeof a.stream=="function"&&typeof a.constructor=="function"&&/^(Blob|File)$/.test(a[nr]),Fo=a=>typeof a=="object"&&(a[nr]==="AbortSignal"||a[nr]==="EventTarget"),Lo=(a,n)=>{let o=new URL(n).hostname,s=new URL(a).hostname;return o===s||o.endsWith(`.${s}`)},Io=(a,n)=>{let o=new URL(n).protocol,s=new URL(a).protocol;return o===s};var Xi=(0,pe.promisify)(K.default.pipeline),H=Symbol("Body internals"),le=class{constructor(n,{size:o=0}={}){let s=null;n===null?n=null:Zr(n)?n=Q.Buffer.from(n.toString()):yt(n)||Q.Buffer.isBuffer(n)||(pe.types.isAnyArrayBuffer(n)?n=Q.Buffer.from(n):ArrayBuffer.isView(n)?n=Q.Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof K.default||(n instanceof We?(n=qo(n),s=n.type.split("=")[1]):n=Q.Buffer.from(String(n))));let l=n;Q.Buffer.isBuffer(n)?l=K.default.Readable.from(n):yt(n)&&(l=K.default.Readable.from(n.stream())),this[H]={body:n,stream:l,boundary:s,disturbed:!1,error:null},this.size=o,n instanceof K.default&&n.on("error",f=>{let m=f instanceof be?f:new N(`Invalid response body while trying to fetch ${this.url}: ${f.message}`,"system",f);this[H].error=m})}get body(){return this[H].stream}get bodyUsed(){return this[H].disturbed}async arrayBuffer(){let{buffer:n,byteOffset:o,byteLength:s}=await en(this);return n.slice(o,o+s)}async formData(){let n=this.headers.get("content-type");if(n.startsWith("application/x-www-form-urlencoded")){let s=new We,l=new URLSearchParams(await this.text());for(let[f,m]of l)s.append(f,m);return s}let{toFormData:o}=await Promise.resolve().then(()=>(Uo(),xo));return o(this.body,n)}async blob(){let n=this.headers&&this.headers.get("content-type")||this[H].body&&this[H].body.type||"",o=await this.arrayBuffer();return new me([o],{type:n})}async json(){let n=await this.text();return JSON.parse(n)}async text(){let n=await en(this);return new TextDecoder().decode(n)}buffer(){return en(this)}};le.prototype.buffer=(0,pe.deprecate)(le.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(le.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,pe.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function en(a){if(a[H].disturbed)throw new TypeError(`body used already for: ${a.url}`);if(a[H].disturbed=!0,a[H].error)throw a[H].error;let{body:n}=a;if(n===null)return Q.Buffer.alloc(0);if(!(n instanceof K.default))return Q.Buffer.alloc(0);let o=[],s=0;try{for await(let l of n){if(a.size>0&&s+l.length>a.size){let f=new N(`content size at ${a.url} over limit: ${a.size}`,"max-size");throw n.destroy(f),f}s+=l.length,o.push(l)}}catch(l){throw l instanceof be?l:new N(`Invalid response body while trying to fetch ${a.url}: ${l.message}`,"system",l)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return o.every(l=>typeof l=="string")?Q.Buffer.from(o.join("")):Q.Buffer.concat(o,s)}catch(l){throw new N(`Could not create Buffer from response body for ${a.url}: ${l.message}`,"system",l)}else throw new N(`Premature close of server response while trying to fetch ${a.url}`)}var Ze=(a,n)=>{let o,s,{body:l}=a[H];if(a.bodyUsed)throw new Error("cannot clone body after it is used");return l instanceof K.default&&typeof l.getBoundary!="function"&&(o=new K.PassThrough({highWaterMark:n}),s=new K.PassThrough({highWaterMark:n}),l.pipe(o),l.pipe(s),a[H].stream=o,l=s),l},es=(0,pe.deprecate)(a=>a.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),sr=(a,n)=>a===null?null:typeof a=="string"?"text/plain;charset=UTF-8":Zr(a)?"application/x-www-form-urlencoded;charset=UTF-8":yt(a)?a.type||null:Q.Buffer.isBuffer(a)||pe.types.isAnyArrayBuffer(a)||ArrayBuffer.isView(a)?null:a instanceof We?`multipart/form-data; boundary=${n[H].boundary}`:a&&typeof a.getBoundary=="function"?`multipart/form-data;boundary=${es(a)}`:a instanceof K.default?null:"text/plain;charset=UTF-8",jo=a=>{let{body:n}=a[H];return n===null?0:yt(n)?n.size:Q.Buffer.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"&&n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null},No=async(a,{body:n})=>{n===null?a.end():await Xi(n,a)};var tn=require("node:util"),_t=Ce(require("node:http"),1),lr=typeof _t.default.validateHeaderName=="function"?_t.default.validateHeaderName:a=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(a)){let n=new TypeError(`Header name must be a valid HTTP token [${a}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},rn=typeof _t.default.validateHeaderValue=="function"?_t.default.validateHeaderValue:(a,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let o=new TypeError(`Invalid character in header content ["${a}"]`);throw Object.defineProperty(o,"code",{value:"ERR_INVALID_CHAR"}),o}},G=class a extends URLSearchParams{constructor(n){let o=[];if(n instanceof a){let s=n.raw();for(let[l,f]of Object.entries(s))o.push(...f.map(m=>[l,m]))}else if(n!=null)if(typeof n=="object"&&!tn.types.isBoxedPrimitive(n)){let s=n[Symbol.iterator];if(s==null)o.push(...Object.entries(n));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");o=[...n].map(l=>{if(typeof l!="object"||tn.types.isBoxedPrimitive(l))throw new TypeError("Each header pair must be an iterable object");return[...l]}).map(l=>{if(l.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...l]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return o=o.length>0?o.map(([s,l])=>(lr(s),rn(s,String(l)),[String(s).toLowerCase(),String(l)])):void 0,super(o),new Proxy(this,{get(s,l,f){switch(l){case"append":case"set":return(m,_)=>(lr(m),rn(m,String(_)),URLSearchParams.prototype[l].call(s,String(m).toLowerCase(),String(_)));case"delete":case"has":case"getAll":return m=>(lr(m),URLSearchParams.prototype[l].call(s,String(m).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,l,f)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(n){let o=this.getAll(n);if(o.length===0)return null;let s=o.join(", ");return/^content-encoding$/i.test(n)&&(s=s.toLowerCase()),s}forEach(n,o=void 0){for(let s of this.keys())Reflect.apply(n,o,[this.get(s),s,this])}*values(){for(let n of this.keys())yield this.get(n)}*entries(){for(let n of this.keys())yield[n,this.get(n)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((n,o)=>(n[o]=this.getAll(o),n),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((n,o)=>{let s=this.getAll(o);return o==="host"?n[o]=s[0]:n[o]=s.length>1?s:s[0],n},{})}};Object.defineProperties(G.prototype,["get","entries","forEach","values"].reduce((a,n)=>(a[n]={enumerable:!0},a),{}));function Ho(a=[]){return new G(a.reduce((n,o,s,l)=>(s%2===0&&n.push(l.slice(s,s+2)),n),[]).filter(([n,o])=>{try{return lr(n),rn(n,String(o)),!0}catch{return!1}}))}var ts=new Set([301,302,303,307,308]),ur=a=>ts.has(a);var oe=Symbol("Response internals"),X=class a extends le{constructor(n=null,o={}){super(n,o);let s=o.status!=null?o.status:200,l=new G(o.headers);if(n!==null&&!l.has("Content-Type")){let f=sr(n,this);f&&l.append("Content-Type",f)}this[oe]={type:"default",url:o.url,status:s,statusText:o.statusText||"",headers:l,counter:o.counter,highWaterMark:o.highWaterMark}}get type(){return this[oe].type}get url(){return this[oe].url||""}get status(){return this[oe].status}get ok(){return this[oe].status>=200&&this[oe].status<300}get redirected(){return this[oe].counter>0}get statusText(){return this[oe].statusText}get headers(){return this[oe].headers}get highWaterMark(){return this[oe].highWaterMark}clone(){return new a(Ze(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(n,o=302){if(!ur(o))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new a(null,{headers:{location:new URL(n).toString()},status:o})}static error(){let n=new a(null,{status:0,statusText:""});return n[oe].type="error",n}static json(n=void 0,o={}){let s=JSON.stringify(n);if(s===void 0)throw new TypeError("data is not JSON serializable");let l=new G(o&&o.headers);return l.has("content-type")||l.set("content-type","application/json"),new a(s,{...o,headers:l})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(X.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var ea=require("node:url"),ta=require("node:util");var Vo=a=>{if(a.search)return a.search;let n=a.href.length-1,o=a.hash||(a.href[n]==="#"?"#":"");return a.href[n-o.length]==="?"?"?":""};var Qo=require("node:net");function Yo(a,n=!1){return a==null||(a=new URL(a),/^(about|blob|data):$/.test(a.protocol))?"no-referrer":(a.username="",a.password="",a.hash="",n&&(a.pathname="",a.search=""),a)}var Go=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Jo="strict-origin-when-cross-origin";function Zo(a){if(!Go.has(a))throw new TypeError(`Invalid referrerPolicy: ${a}`);return a}function rs(a){if(/^(http|ws)s:$/.test(a.protocol))return!0;let n=a.host.replace(/(^\[)|(]$)/g,""),o=(0,Qo.isIP)(n);return o===4&&/^127\./.test(n)||o===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(n)?!0:a.host==="localhost"||a.host.endsWith(".localhost")?!1:a.protocol==="file:"}function Ke(a){return/^about:(blank|srcdoc)$/.test(a)||a.protocol==="data:"||/^(blob|filesystem):$/.test(a.protocol)?!0:rs(a)}function Ko(a,{referrerURLCallback:n,referrerOriginCallback:o}={}){if(a.referrer==="no-referrer"||a.referrerPolicy==="")return null;let s=a.referrerPolicy;if(a.referrer==="about:client")return"no-referrer";let l=a.referrer,f=Yo(l),m=Yo(l,!0);f.toString().length>4096&&(f=m),n&&(f=n(f)),o&&(m=o(m));let _=new URL(a.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return m;case"unsafe-url":return f;case"strict-origin":return Ke(f)&&!Ke(_)?"no-referrer":m.toString();case"strict-origin-when-cross-origin":return f.origin===_.origin?f:Ke(f)&&!Ke(_)?"no-referrer":m;case"same-origin":return f.origin===_.origin?f:"no-referrer";case"origin-when-cross-origin":return f.origin===_.origin?f:m;case"no-referrer-when-downgrade":return Ke(f)&&!Ke(_)?"no-referrer":f;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function Xo(a){let n=(a.get("referrer-policy")||"").split(/[,\s]+/),o="";for(let s of n)s&&Go.has(s)&&(o=s);return o}var x=Symbol("Request internals"),St=a=>typeof a=="object"&&typeof a[x]=="object",ns=(0,ta.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Fe=class a extends le{constructor(n,o={}){let s;if(St(n)?s=new URL(n.url):(s=new URL(n),n={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentials.`);let l=o.method||n.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(l)&&(l=l.toUpperCase()),!St(o)&&"data"in o&&ns(),(o.body!=null||St(n)&&n.body!==null)&&(l==="GET"||l==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let f=o.body?o.body:St(n)&&n.body!==null?Ze(n):null;super(f,{size:o.size||n.size||0});let m=new G(o.headers||n.headers||{});if(f!==null&&!m.has("Content-Type")){let b=sr(f,this);b&&m.set("Content-Type",b)}let _=St(n)?n.signal:null;if("signal"in o&&(_=o.signal),_!=null&&!Fo(_))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let y=o.referrer==null?n.referrer:o.referrer;if(y==="")y="no-referrer";else if(y){let b=new URL(y);y=/^about:(\/\/)?client$/.test(b)?"client":b}else y=void 0;this[x]={method:l,redirect:o.redirect||n.redirect||"follow",headers:m,parsedURL:s,signal:_,referrer:y},this.follow=o.follow===void 0?n.follow===void 0?20:n.follow:o.follow,this.compress=o.compress===void 0?n.compress===void 0?!0:n.compress:o.compress,this.counter=o.counter||n.counter||0,this.agent=o.agent||n.agent,this.highWaterMark=o.highWaterMark||n.highWaterMark||16384,this.insecureHTTPParser=o.insecureHTTPParser||n.insecureHTTPParser||!1,this.referrerPolicy=o.referrerPolicy||n.referrerPolicy||""}get method(){return this[x].method}get url(){return(0,ea.format)(this[x].parsedURL)}get headers(){return this[x].headers}get redirect(){return this[x].redirect}get signal(){return this[x].signal}get referrer(){if(this[x].referrer==="no-referrer")return"";if(this[x].referrer==="client")return"about:client";if(this[x].referrer)return this[x].referrer.toString()}get referrerPolicy(){return this[x].referrerPolicy}set referrerPolicy(n){this[x].referrerPolicy=Zo(n)}clone(){return new a(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Fe.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var ra=a=>{let{parsedURL:n}=a[x],o=new G(a[x].headers);o.has("Accept")||o.set("Accept","*/*");let s=null;if(a.body===null&&/^(post|put)$/i.test(a.method)&&(s="0"),a.body!==null){let _=jo(a);typeof _=="number"&&!Number.isNaN(_)&&(s=String(_))}s&&o.set("Content-Length",s),a.referrerPolicy===""&&(a.referrerPolicy=Jo),a.referrer&&a.referrer!=="no-referrer"?a[x].referrer=Ko(a):a[x].referrer="no-referrer",a[x].referrer instanceof URL&&o.set("Referer",a.referrer),o.has("User-Agent")||o.set("User-Agent","node-fetch"),a.compress&&!o.has("Accept-Encoding")&&o.set("Accept-Encoding","gzip, deflate, br");let{agent:l}=a;typeof l=="function"&&(l=l(n)),!o.has("Connection")&&!l&&o.set("Connection","close");let f=Vo(n),m={path:n.pathname+f,method:a.method,headers:o[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:a.insecureHTTPParser,agent:l};return{parsedURL:n,options:m}};var fr=class extends be{constructor(n,o="aborted"){super(n,o)}};rr();Kr();var os=new Set(["data:","http:","https:"]);async function dr(a,n){return new Promise((o,s)=>{let l=new Fe(a,n),{parsedURL:f,options:m}=ra(l);if(!os.has(f.protocol))throw new TypeError(`node-fetch cannot load ${a}. URL scheme "${f.protocol.replace(/:$/,"")}" is not supported.`);if(f.protocol==="data:"){let h=Po(l.url),q=new X(h,{headers:{"Content-Type":h.typeFull}});o(q);return}let _=(f.protocol==="https:"?oa.default:na.default).request,{signal:y}=l,b=null,E=()=>{let h=new fr("The operation was aborted.");s(h),l.body&&l.body instanceof J.default.Readable&&l.body.destroy(h),!(!b||!b.body)&&b.body.emit("error",h)};if(y&&y.aborted){E();return}let R=()=>{E(),p()},S=_(f.toString(),m);y&&y.addEventListener("abort",R);let p=()=>{S.abort(),y&&y.removeEventListener("abort",R)};S.on("error",h=>{s(new N(`request to ${l.url} failed, reason: ${h.message}`,"system",h)),p()}),as(S,h=>{b&&b.body&&b.body.destroy(h)}),process.version<"v14"&&S.on("socket",h=>{let q;h.prependListener("end",()=>{q=h._eventsCount}),h.prependListener("close",v=>{if(b&&q<h._eventsCount&&!v){let T=new Error("Premature close");T.code="ERR_STREAM_PREMATURE_CLOSE",b.body.emit("error",T)}})}),S.on("response",h=>{S.setTimeout(0);let q=Ho(h.rawHeaders);if(ur(h.statusCode)){let P=q.get("Location"),L=null;try{L=P===null?null:new URL(P,l.url)}catch{if(l.redirect!=="manual"){s(new N(`uri requested responds with an invalid redirect URL: ${P}`,"invalid-redirect")),p();return}}switch(l.redirect){case"error":s(new N(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),p();return;case"manual":break;case"follow":{if(L===null)break;if(l.counter>=l.follow){s(new N(`maximum redirect reached at: ${l.url}`,"max-redirect")),p();return}let k={headers:new G(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:Ze(l),signal:l.signal,size:l.size,referrer:l.referrer,referrerPolicy:l.referrerPolicy};if(!Lo(l.url,L)||!Io(l.url,L))for(let V of["authorization","www-authenticate","cookie","cookie2"])k.headers.delete(V);if(h.statusCode!==303&&l.body&&n.body instanceof J.default.Readable){s(new N("Cannot follow redirect with body being a readable stream","unsupported-redirect")),p();return}(h.statusCode===303||(h.statusCode===301||h.statusCode===302)&&l.method==="POST")&&(k.method="GET",k.body=void 0,k.headers.delete("content-length"));let ae=Xo(q);ae&&(k.referrerPolicy=ae),o(dr(new Fe(L,k))),p();return}default:return s(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}y&&h.once("end",()=>{y.removeEventListener("abort",R)});let v=(0,J.pipeline)(h,new J.PassThrough,P=>{P&&s(P)});process.version<"v12.10"&&h.on("aborted",R);let T={url:l.url,status:h.statusCode,statusText:h.statusMessage,headers:q,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},I=q.get("Content-Encoding");if(!l.compress||l.method==="HEAD"||I===null||h.statusCode===204||h.statusCode===304){b=new X(v,T),o(b);return}let O={flush:Le.default.Z_SYNC_FLUSH,finishFlush:Le.default.Z_SYNC_FLUSH};if(I==="gzip"||I==="x-gzip"){v=(0,J.pipeline)(v,Le.default.createGunzip(O),P=>{P&&s(P)}),b=new X(v,T),o(b);return}if(I==="deflate"||I==="x-deflate"){let P=(0,J.pipeline)(h,new J.PassThrough,L=>{L&&s(L)});P.once("data",L=>{(L[0]&15)===8?v=(0,J.pipeline)(v,Le.default.createInflate(),k=>{k&&s(k)}):v=(0,J.pipeline)(v,Le.default.createInflateRaw(),k=>{k&&s(k)}),b=new X(v,T),o(b)}),P.once("end",()=>{b||(b=new X(v,T),o(b))});return}if(I==="br"){v=(0,J.pipeline)(v,Le.default.createBrotliDecompress(),P=>{P&&s(P)}),b=new X(v,T),o(b);return}b=new X(v,T),o(b)}),No(S,l).catch(s)})}function as(a,n){let o=wt.Buffer.from(`0\r
\r
`),s=!1,l=!1,f;a.on("response",m=>{let{headers:_}=m;s=_["transfer-encoding"]==="chunked"&&!_["content-length"]}),a.on("socket",m=>{let _=()=>{if(s&&!l){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",n(b)}},y=b=>{l=wt.Buffer.compare(b.slice(-5),o)===0,!l&&f&&(l=wt.Buffer.compare(f.slice(-3),o.slice(0,3))===0&&wt.Buffer.compare(b.slice(-2),o.slice(3))===0),f=b};m.prependListener("close",_),m.on("data",y),a.on("close",()=>{m.removeListener("close",_),m.removeListener("data",y)})})}var cr,hr,is=async a=>{cr={baseURL:"https://bard.google.com",headers:{Host:"bard.google.com","X-Same-Domain":"1","User-Agent":"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Origin:"https://bard.google.com",Referer:"https://bard.google.com/",Cookie:`__Secure-1PSID=${a};`}};let s=(await(await fetch("https://bard.google.com/",{method:"GET",headers:cr.headers,credentials:"include"})).text()).match(/SNlM0e":"(.*?)"/);if(s)hr=s[1];else throw new Error("Could not get Google Bard.");return hr},nn=async(a,n={})=>{if(!hr)throw new Error("Make sure to call Bard.init(SESSION_ID) first.");let o={bl:"boq_assistant-bard-web-server_20230711.08_p0",_reqID:n._reqID?`${n._reqID}`:"0",rt:"c"},s=[[a],null,n?Object.values(n).slice(0,3):[null,null,null]],l={"f.req":JSON.stringify([null,JSON.stringify(s)]),at:hr},f=new URL("/_/BardChatUi/data/assistant.lamda.BardFrontendService/StreamGenerate",cr.baseURL);Object.keys(o).forEach(h=>f.searchParams.append(h,o[h]));let m=[];for(let h in l){let q=encodeURIComponent(h),v=encodeURIComponent(l[h]);m.push(q+"="+v)}m=m.join("&");let y=await(await fetch(f.toString(),{method:"POST",headers:cr.headers,body:m,credentials:"include"})).text(),b=JSON.parse(y.split(`
`)[3])[0][2];if(!b)throw new Error(`Google Bard encountered an error ${y}.`);let E=JSON.parse(b),R=JSON.parse(b)[4][0],S=R[1][0],p=R[4]?.map(h=>({tag:h[2],url:h[3][0][0],source:{original:h[0][0][0],website:h[1][0][0],name:h[1][1],favicon:h[1][3]}}));return{content:ss(S,p),images:p,ids:{conversationID:E[1][0],responseID:E[1][1],choiceID:E[4][0][0],_reqID:parseInt(n._reqID??0)+1e5}}},ss=(a,n)=>{if(!n)return a;for(let o of n){let s=`!${o.tag}(${o.url})`;a=a.replace(new RegExp("(?<!!)"+o.tag.replace("[","\\[").replace("]","\\]")),s)}return a},an=async(a,n=!1)=>n?await nn(a):(await nn(a)).content,on=class{constructor(n){this.ids=n}async ask(n,o=!1){let s=await nn(n,this.ids);return this.ids={...s.ids},o?s:s.content}export(){return this.ids}},aa={init:is,askAI:an,Chat:on};globalThis.fetch=dr;function sn(a,n,o="text",s,l){o==="text"&&(a+=` Return your response as a JSON with key 'response', and key 'explanation'. The value associated with 'response' should be a single string with your answer. The value associated with 'explanation' should be a string describing what you did. Be sure to be elaborate with your explanation, giving specific examples of what you did. If you did nothing, then simply say that. ONLY return that JSON and nothing else. Be accurate and concise. 

`),o==="code"&&(a+=` Return your response in a codeblock. DO NOT ADD ANY EXTRA CODE UNLESS TOLD TO. 

 Then add a JSON IN A SEPERATE CODEBLOCK at the end with ONE key, 'explanation'. The value associated with 'explanation' should be a string describing the code you have written, what you have changed, or WHY you wrote what you wrote. 

`);let f=(0,F.getPreferenceValues)(),[m,_]=(0,Ie.useState)(""),[y,b]=(0,Ie.useState)(!0),[E,R]=(0,Ie.useState)(""),[S,p]=(0,Ie.useState)(!1);async function h(){let v=new Date,T=await(0,F.showToast)(F.Toast.Style.Animated,n);async function I(){let O="";try{O=await(0,F.getSelectedText)(),a?l&&(O=`

`+O):a=O}catch{if(!a){T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F No input was provided."),p(!0);return}if(!l){T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F Raycast was unable to get the selected text."),p(!0);return}}try{return await aa.init(f["__Secure-1PSID"]),await an(`${a}${O}`)}catch{T.title="Error",T.style=F.Toast.Style.Failure,b(!1),_("\u26A0\uFE0F Unable to reach Bard at this time."),p(!0);return}}I().then(O=>{if(!O)return;if(o==="text"){let L=O.match(/"response": "([^"]*)"/),k=O.match(/"explanation": "([^"]*)"/);L[1]?_(`## AI Response:
`+L[1].trim()+`


 ## Explanation: 
`+k[1].trim()):_(O),R(L[1].trim())}else if(o==="code"){let L=O.match(/(```[a-zA-Z]+?.*?```)/s),k=O.match(/```([a-zA-Z]+)?(.*?)```/s),ae=O.match(/"explanation": "([^"]*)"/);_(k?`## AI Code Response:
`+L[0].trim()+`


 ## Explanation: 
`+ae[1].trim():O),R(k[2].trim())}else _(O),R(O);b(!1),T.style=F.Toast.Style.Success;let P=(new Date().getTime()-v.getTime())/1e3;T.title=`Finished in ${P} seconds`})}async function q(){b(!0),_(""),h()}return(0,Ie.useEffect)(()=>{h()},[]),_jsx(F.Detail,{markdown:m,isLoading:y,actions:!y&&_jsx(F.ActionPanel,{title:"Actions"},_jsx(F.Action.CopyToClipboard,{title:"Copy Results",content:E}),_jsx(F.Action.Paste,{title:"Paste Results",content:E}),_jsx(F.Action,{title:"Retry",onAction:q,shortcut:{modifiers:["cmd"],key:"r"},icon:F.Icon.Repeat})),metadata:_jsx(F.Detail.Metadata,null,_jsx(F.Detail.Metadata.Label,{title:"Command Type",text:o.charAt(0).toUpperCase()+o.slice(1)}),_jsx(F.Detail.Metadata.Label,{title:"Command Title",text:s}),_jsx(F.Detail.Metadata.Separator,null),_jsx(F.Detail.Metadata.Label,{title:"Model",text:"PaLM 2"}),_jsx(F.Detail.Metadata.Label,{title:"Version",text:"2023.07.13"}))})}var ls="Making longer...";function ia(){return sn(`Make the following text longer without providing any extra information than what's given.

`,ls,"text","Make Longer")}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> *)
*/
